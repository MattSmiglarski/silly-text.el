;;; silly-text.el -- Modify text with silly, obscure Unicode.
;;;
;;; Commentary:
;;;
;;; Support flip and widen.
;;;
;;; Flip changes "foo bar" to "ɹɐq ooɟ".
;;; Widen changes "foo bar" to "ｆｏｏ ｂａｒ".
;;;
;;; Assumes UTF-8.
;;;
;;; Usage:
;;;
;;; (flip-string "The message to be flipped") ;; => ""pǝddᴉlɟ ǝb oʇ ǝƃɐssǝɯ ǝɥ┴"
;;; M-x flip-buffer RET
;;; M-x flip-region RET
;;;
;;; Similar functions exist for widen-* and script-*:
;;;
;;; Examples:
;;;
;;; ˙pǝddᴉlɟ sᴉ ǝƃɐssǝɯ sᴉɥ┴
;;; Ｔｈｉｓ ｍｅｓｓａｇｅ ｉｓ ｗｉｄｅｎｅｄ．
;;; 𝓣𝓱𝓲𝓼 𝓶𝓮𝓼𝓼𝓪𝓰𝓮 𝓲𝓼 𝓼𝓬𝓻𝓲𝓹𝓽𝓮𝓭.
;;;

;;; Code:

(defvar flip-alist
  '(("a" . "ɐ")
    ("b" . "q")
    ("c" . "ɔ")
    ("d" . "p")
    ("e" . "ǝ")
    ("f" . "ɟ")
    ("g" . "ƃ")
    ("h" . "ɥ")
    ("i" . "ᴉ")
    ("j" . "ɾ")
    ("k" . "ʞ")
    ("m" . "ɯ")
    ("n" . "u")
    ("r" . "ɹ")
    ("t" . "ʇ")
    ("v" . "ʌ")
    ("w" . "ʍ")
    ("y" . "ʎ")
    ("A" . "∀")
    ("B" . "q")
    ("C" . "Ɔ")
    ("D" . "p")
    ("E" . "Ǝ")
    ("F" . "Ⅎ")
    ("G" . "פ")
    ("J" . "ſ")
    ("L" . "˥")
    ("M" . "W")
    ("P" . "Ԁ")
    ("R" . "ɹ")
    ("T" . "┴")
    ("U" . "∩")
    ("V" . "Λ")
    ("Y" . "⅄")
    ("1" . "Ɩ")
    ("2" . "ᄅ")
    ("3" . "Ɛ")
    ("4" . "ㄣ")
    ("5" . "ϛ")
    ("6" . "9")
    ("7" . "ㄥ")
    ("8" . "8")
    ("," . "'")
    ("." . "˙")
    ("?" . "¿")
    ("!" . "¡")
    ("\"" . ",")
    ("'" . ",")
    ("`" . ",")
    ("'" . ",")
    ("(" . ")")
    (")" . "(")
    ("[" . "]")
    ("]" . "[")
    ("{" . "}")
    ("<" . ">")
    (">" . "<")
    ("&" . "⅋")
    ("_" . "‾")
    "An alist for flipping characters."))

(defvar widen-alist
  '(("!" . "！")
    ("\"" . "＂")
    ("#" . "＃")
    ("$" . "＄")
    ("%" . "％")
    ("&" . "＆")
    ("'" . "＇")
    ("(" . "（")
    (")" . "）")
    ("*" . "＊")
    ("+" . "＋")
    ("," . "，")
    ("-" . "－")
    ("." . "．")
    ("/" . "／")
    ("0" . "０")
    ("1" . "１")
    ("2" . "２")
    ("3" . "３")
    ("4" . "４")
    ("5" . "５")
    ("6" . "６")
    ("7" . "７")
    ("8" . "８")
    ("9" . "９")
    (":" . "：")
    (";" . "；")
    ("<" . "＜")
    ("=" . "＝")
    (">" . "＞")
    ("?" . "？")
    ("@" . "＠")
    ("A" . "Ａ")
    ("B" . "Ｂ")
    ("C" . "Ｃ")
    ("D" . "Ｄ")
    ("E" . "Ｅ")
    ("F" . "Ｆ")
    ("G" . "Ｇ")
    ("H" . "Ｈ")
    ("I" . "Ｉ")
    ("J" . "Ｊ")
    ("K" . "Ｋ")
    ("L" . "Ｌ")
    ("M" . "Ｍ")
    ("N" . "Ｎ")
    ("O" . "Ｏ")
    ("P" . "Ｐ")
    ("Q" . "Ｑ")
    ("R" . "Ｒ")
    ("S" . "Ｓ")
    ("T" . "Ｔ")
    ("U" . "Ｕ")
    ("V" . "Ｖ")
    ("W" . "Ｗ")
    ("X" . "Ｘ")
    ("Y" . "Ｙ")
    ("[" . "Ｚ")
    ("\\" . "［")
    ("]" . "＼")
    ("^" . "］")
    ("_" . "＾")
    ("`" . "＿")
    ("^" . "＾")
    ("_" . "＿")
    ("`" . "｀")
    ("a" . "ａ")
    ("b" . "ｂ")
    ("c" . "ｃ")
    ("d" . "ｄ")
    ("e" . "ｅ")
    ("f" . "ｆ")
    ("g" . "ｇ")
    ("h" . "ｈ")
    ("i" . "ｉ")
    ("j" . "ｊ")
    ("k" . "ｋ")
    ("l" . "ｌ")
    ("m" . "ｍ")
    ("n" . "ｎ")
    ("o" . "ｏ")
    ("p" . "ｐ")
    ("q" . "ｑ")
    ("r" . "ｒ")
    ("s" . "ｓ")
    ("t" . "ｔ")
    ("u" . "ｕ")
    ("v" . "ｖ")
    ("w" . "ｗ")
    ("x" . "ｘ")
    ("y" . "ｙ")
    ("z" . "ｚ")
    ("{" . "｛")
    ("|" . "｜")
    ("}" . "｝")
    ("~" . "～")
    "An alist for widening characters."))

(defvar script-alist
  '(("A" . "𝓐")
    ("B" . "𝓑")
    ("C" . "𝓒")
    ("D" . "𝓓")
    ("E" . "𝓔")
    ("F" . "𝓕")
    ("G" . "𝓖")
    ("H" . "𝓗")
    ("I" . "𝓘")
    ("J" . "𝓙")
    ("K" . "𝓚")
    ("L" . "𝓛")
    ("M" . "𝓜")
    ("N" . "𝓝")
    ("O" . "𝓞")
    ("P" . "𝓟")
    ("Q" . "𝓠")
    ("R" . "𝓡")
    ("S" . "𝓢")
    ("T" . "𝓣")
    ("U" . "𝓤")
    ("V" . "𝓥")
    ("W" . "𝓦")
    ("X" . "𝓧")
    ("Y" . "𝓨")
    ("Z" . "𝓩")
    ("a" . "𝓪")
    ("b" . "𝓫")
    ("c" . "𝓬")
    ("d" . "𝓭")
    ("e" . "𝓮")
    ("f" . "𝓯")
    ("g" . "𝓰")
    ("h" . "𝓱")
    ("i" . "𝓲")
    ("j" . "𝓳")
    ("k" . "𝓴")
    ("l" . "𝓵")
    ("m" . "𝓶")
    ("n" . "𝓷")
    ("o" . "𝓸")
    ("p" . "𝓹")
    ("q" . "𝓺")
    ("r" . "𝓻")
    ("s" . "𝓼")
    ("t" . "𝓽")
    ("u" . "𝓾")
    ("v" . "𝓿")
    ("w" . "𝔀")
    ("x" . "𝔁")
    ("y" . "𝔂")
    ("z" . "𝔃")
    "An alist for scripting characters."))

(defun flip-string (string)
  "Flips STRING upside down."
  (interactive "M")
  (apply #'concat
         (reverse
          (mapcar (lambda (x)
                    (or (cdr (assoc (char-to-string x) flip-alist))
                        (car (rassoc (char-to-string x) flip-alist))
                        (char-to-string x)))
                  (string-to-list string)))))

(defun flip-region (start end)
  "Flips the contents between START and END."
  (interactive "*r")
  (let ((text (buffer-substring start end)))
    (delete-region start end)
    (insert (flip-string text))))

(defun flip-buffer (buffer)
  "Flips the contents of BUFFER."
  (interactive "*b")
  (with-current-buffer buffer
    (flip-region (point-min) (point-max))))

(defun widenize-string (string)
  "Widen the contents of STRING."
  (interactive "M")
  (apply #'concat
         (mapcar (lambda (x)
                   (or (cdr (assoc (char-to-string x) widen-alist))
                       (char-to-string x)))
                 (string-to-list string))))

(defun widenize-region (start end)
  "Widen the contents between START and END."
  (interactive "*r")
  (let ((text (buffer-substring start end)))
    (delete-region start end)
    (insert (widenize-string text))))

(defun widenize-buffer (buffer)
  "Widen the contents of BUFFER."
  (interactive "*b")
  (with-current-buffer buffer
    (widenize-region (point-min) (point-max))))

(defun script-string (string)
  "Scriptify the contents of STRING."
  (interactive "M")
  (apply #'concat
         (mapcar (lambda (x)
                   (or (cdr (assoc (char-to-string x) script-alist))
                       (char-to-string x)))
                 (string-to-list string))))

(defun script-region (start end)
  "Scriptify the contents between START and END."
  (interactive "*r")
  (let ((text (buffer-substring start end)))
    (delete-region start end)
    (insert (script-string text))))

(defun script-buffer (buffer)
  "Scriptify the contents of BUFFER."
  (interactive "*b")
  (with-current-buffer buffer
    (script-region (point-min) (point-max))))

(provide 'silly-text)
;;; silly-text.el ends here
