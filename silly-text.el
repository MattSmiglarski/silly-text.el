;;; silly-text.el -- Modify text with silly, obscure Unicode.
;;;
;;; Commentary:
;;;
;;; Support flip and widen.
;;;
;;; Flip changes "foo bar" to "É¹Éq ooÉŸ".
;;; Widen changes "foo bar" to "ï½†ï½ï½ ï½‚ï½ï½’".
;;;
;;; Assumes UTF-8.
;;;
;;; Usage:
;;;
;;; (flip-string "The message to be flipped") ;; => ""pÇddá´‰lÉŸ Çb oÊ‡ ÇÆƒÉssÇÉ¯ ÇÉ¥â”´"
;;; M-x flip-buffer RET
;;; M-x flip-region RET
;;;
;;; Similar functions exist for widen-* and script-*:
;;;
;;; Examples:
;;;
;;; Ë™pÇddá´‰lÉŸ sá´‰ ÇÆƒÉssÇÉ¯ sá´‰É¥â”´
;;; ï¼´ï½ˆï½‰ï½“ ï½ï½…ï½“ï½“ï½ï½‡ï½… ï½‰ï½“ ï½—ï½‰ï½„ï½…ï½ï½…ï½„ï¼
;;; ğ“£ğ“±ğ“²ğ“¼ ğ“¶ğ“®ğ“¼ğ“¼ğ“ªğ“°ğ“® ğ“²ğ“¼ ğ“¼ğ“¬ğ“»ğ“²ğ“¹ğ“½ğ“®ğ“­.
;;;

;;; Code:

(defvar flip-alist
  '(("a" . "É")
    ("b" . "q")
    ("c" . "É”")
    ("d" . "p")
    ("e" . "Ç")
    ("f" . "ÉŸ")
    ("g" . "Æƒ")
    ("h" . "É¥")
    ("i" . "á´‰")
    ("j" . "É¾")
    ("k" . "Ê")
    ("m" . "É¯")
    ("n" . "u")
    ("r" . "É¹")
    ("t" . "Ê‡")
    ("v" . "ÊŒ")
    ("w" . "Ê")
    ("y" . "Ê")
    ("A" . "âˆ€")
    ("B" . "q")
    ("C" . "Æ†")
    ("D" . "p")
    ("E" . "Æ")
    ("F" . "â„²")
    ("G" . "×¤")
    ("J" . "Å¿")
    ("L" . "Ë¥")
    ("M" . "W")
    ("P" . "Ô€")
    ("R" . "É¹")
    ("T" . "â”´")
    ("U" . "âˆ©")
    ("V" . "Î›")
    ("Y" . "â…„")
    ("1" . "Æ–")
    ("2" . "á„…")
    ("3" . "Æ")
    ("4" . "ã„£")
    ("5" . "Ï›")
    ("6" . "9")
    ("7" . "ã„¥")
    ("8" . "8")
    ("," . "'")
    ("." . "Ë™")
    ("?" . "Â¿")
    ("!" . "Â¡")
    ("\"" . ",")
    ("'" . ",")
    ("`" . ",")
    ("'" . ",")
    ("(" . ")")
    (")" . "(")
    ("[" . "]")
    ("]" . "[")
    ("{" . "}")
    ("<" . ">")
    (">" . "<")
    ("&" . "â…‹")
    ("_" . "â€¾")
    "An alist for flipping characters."))

(defvar widen-alist
  '(("!" . "ï¼")
    ("\"" . "ï¼‚")
    ("#" . "ï¼ƒ")
    ("$" . "ï¼„")
    ("%" . "ï¼…")
    ("&" . "ï¼†")
    ("'" . "ï¼‡")
    ("(" . "ï¼ˆ")
    (")" . "ï¼‰")
    ("*" . "ï¼Š")
    ("+" . "ï¼‹")
    ("," . "ï¼Œ")
    ("-" . "ï¼")
    ("." . "ï¼")
    ("/" . "ï¼")
    ("0" . "ï¼")
    ("1" . "ï¼‘")
    ("2" . "ï¼’")
    ("3" . "ï¼“")
    ("4" . "ï¼”")
    ("5" . "ï¼•")
    ("6" . "ï¼–")
    ("7" . "ï¼—")
    ("8" . "ï¼˜")
    ("9" . "ï¼™")
    (":" . "ï¼š")
    (";" . "ï¼›")
    ("<" . "ï¼œ")
    ("=" . "ï¼")
    (">" . "ï¼")
    ("?" . "ï¼Ÿ")
    ("@" . "ï¼ ")
    ("A" . "ï¼¡")
    ("B" . "ï¼¢")
    ("C" . "ï¼£")
    ("D" . "ï¼¤")
    ("E" . "ï¼¥")
    ("F" . "ï¼¦")
    ("G" . "ï¼§")
    ("H" . "ï¼¨")
    ("I" . "ï¼©")
    ("J" . "ï¼ª")
    ("K" . "ï¼«")
    ("L" . "ï¼¬")
    ("M" . "ï¼­")
    ("N" . "ï¼®")
    ("O" . "ï¼¯")
    ("P" . "ï¼°")
    ("Q" . "ï¼±")
    ("R" . "ï¼²")
    ("S" . "ï¼³")
    ("T" . "ï¼´")
    ("U" . "ï¼µ")
    ("V" . "ï¼¶")
    ("W" . "ï¼·")
    ("X" . "ï¼¸")
    ("Y" . "ï¼¹")
    ("[" . "ï¼º")
    ("\\" . "ï¼»")
    ("]" . "ï¼¼")
    ("^" . "ï¼½")
    ("_" . "ï¼¾")
    ("`" . "ï¼¿")
    ("^" . "ï¼¾")
    ("_" . "ï¼¿")
    ("`" . "ï½€")
    ("a" . "ï½")
    ("b" . "ï½‚")
    ("c" . "ï½ƒ")
    ("d" . "ï½„")
    ("e" . "ï½…")
    ("f" . "ï½†")
    ("g" . "ï½‡")
    ("h" . "ï½ˆ")
    ("i" . "ï½‰")
    ("j" . "ï½Š")
    ("k" . "ï½‹")
    ("l" . "ï½Œ")
    ("m" . "ï½")
    ("n" . "ï½")
    ("o" . "ï½")
    ("p" . "ï½")
    ("q" . "ï½‘")
    ("r" . "ï½’")
    ("s" . "ï½“")
    ("t" . "ï½”")
    ("u" . "ï½•")
    ("v" . "ï½–")
    ("w" . "ï½—")
    ("x" . "ï½˜")
    ("y" . "ï½™")
    ("z" . "ï½š")
    ("{" . "ï½›")
    ("|" . "ï½œ")
    ("}" . "ï½")
    ("~" . "ï½")
    "An alist for widening characters."))

(defvar script-alist
  '(("A" . "ğ“")
    ("B" . "ğ“‘")
    ("C" . "ğ“’")
    ("D" . "ğ““")
    ("E" . "ğ“”")
    ("F" . "ğ“•")
    ("G" . "ğ“–")
    ("H" . "ğ“—")
    ("I" . "ğ“˜")
    ("J" . "ğ“™")
    ("K" . "ğ“š")
    ("L" . "ğ“›")
    ("M" . "ğ“œ")
    ("N" . "ğ“")
    ("O" . "ğ“")
    ("P" . "ğ“Ÿ")
    ("Q" . "ğ“ ")
    ("R" . "ğ“¡")
    ("S" . "ğ“¢")
    ("T" . "ğ“£")
    ("U" . "ğ“¤")
    ("V" . "ğ“¥")
    ("W" . "ğ“¦")
    ("X" . "ğ“§")
    ("Y" . "ğ“¨")
    ("Z" . "ğ“©")
    ("a" . "ğ“ª")
    ("b" . "ğ“«")
    ("c" . "ğ“¬")
    ("d" . "ğ“­")
    ("e" . "ğ“®")
    ("f" . "ğ“¯")
    ("g" . "ğ“°")
    ("h" . "ğ“±")
    ("i" . "ğ“²")
    ("j" . "ğ“³")
    ("k" . "ğ“´")
    ("l" . "ğ“µ")
    ("m" . "ğ“¶")
    ("n" . "ğ“·")
    ("o" . "ğ“¸")
    ("p" . "ğ“¹")
    ("q" . "ğ“º")
    ("r" . "ğ“»")
    ("s" . "ğ“¼")
    ("t" . "ğ“½")
    ("u" . "ğ“¾")
    ("v" . "ğ“¿")
    ("w" . "ğ”€")
    ("x" . "ğ”")
    ("y" . "ğ”‚")
    ("z" . "ğ”ƒ")
    "An alist for scripting characters."))

(defun flip-string (string)
  "Flips STRING upside down."
  (interactive "M")
  (apply #'concat
         (reverse
          (mapcar (lambda (x)
                    (or (cdr (assoc (char-to-string x) flip-alist))
                        (car (rassoc (char-to-string x) flip-alist))
                        (char-to-string x)))
                  (string-to-list string)))))

(defun flip-region (start end)
  "Flips the contents between START and END."
  (interactive "*r")
  (let ((text (buffer-substring start end)))
    (delete-region start end)
    (insert (flip-string text))))

(defun flip-buffer (buffer)
  "Flips the contents of BUFFER."
  (interactive "*b")
  (with-current-buffer buffer
    (flip-region (point-min) (point-max))))

(defun widenize-string (string)
  "Widen the contents of STRING."
  (interactive "M")
  (apply #'concat
         (mapcar (lambda (x)
                   (or (cdr (assoc (char-to-string x) widen-alist))
                       (char-to-string x)))
                 (string-to-list string))))

(defun widenize-region (start end)
  "Widen the contents between START and END."
  (interactive "*r")
  (let ((text (buffer-substring start end)))
    (delete-region start end)
    (insert (widenize-string text))))

(defun widenize-buffer (buffer)
  "Widen the contents of BUFFER."
  (interactive "*b")
  (with-current-buffer buffer
    (widenize-region (point-min) (point-max))))

(defun script-string (string)
  "Scriptify the contents of STRING."
  (interactive "M")
  (apply #'concat
         (mapcar (lambda (x)
                   (or (cdr (assoc (char-to-string x) script-alist))
                       (char-to-string x)))
                 (string-to-list string))))

(defun script-region (start end)
  "Scriptify the contents between START and END."
  (interactive "*r")
  (let ((text (buffer-substring start end)))
    (delete-region start end)
    (insert (script-string text))))

(defun script-buffer (buffer)
  "Scriptify the contents of BUFFER."
  (interactive "*b")
  (with-current-buffer buffer
    (script-region (point-min) (point-max))))

(provide 'silly-text)
;;; silly-text.el ends here
